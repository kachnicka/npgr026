# Spectrum
```
./spectrum --demo
REFERENCE:
<A1>    < A >   83.35   37.84   10.54   <D65>   80.79   82.44   80.84   <F11>   1867.80 1243.61 704.05
<E2>    < A >   11.99   2.01    0.03    <D65>   13.03   4.42    2.02    <F11>   274.45  66.78   13.33
<F4>    < A >   6.33    11.02   -0.18   <D65>   2.76    24.67   2.61    <F11>   118.61  378.68  -0.67
<G4>    < A >   34.51   -1.38   -0.22   <D65>   35.52   -0.60   1.09    <F11>   680.00  -3.56   3.49
<H4>    < A >   69.19   22.74   -2.91   <D65>   73.73   48.95   -2.29   <F11>   1520.02 812.03  -87.00
<J4>    < A >   1.12    8.60    5.43    <D65>   -5.53   20.42   32.49   <F11>   30.39   260.78  290.40

Full spectral evaluation:
<A1>    < A >   83.35   37.84   10.52   <D65>   80.79   82.45   80.68   <F11>   1865.39 1243.94 701.38
<E2>    < A >   11.97   2.02    0.03    <D65>   13.01   4.43    2.03    <F11>   273.39  67.19   13.29
<F4>    < A >   6.39    10.98   -0.16   <D65>   2.87    24.57   2.69    <F11>   120.25  377.61  -0.04
<G4>    < A >   34.56   -1.34   -0.23   <D65>   35.60   -0.54   1.08    <F11>   680.47  -2.54   3.32
<H4>    < A >   69.17   22.70   -2.89   <D65>   73.72   48.86   -2.20   <F11>   1518.03 810.68  -86.10
<J4>    < A >   1.17    8.61    5.42    <D65>   -5.44   20.42   32.44   <F11>   31.10   261.20  289.75
ABS DIFF:
<A1>    < A >   0.00    0.00    0.02    <D65>   0.00    0.01    0.16    <F11>   2.41    0.33    2.67
<E2>    < A >   0.02    0.01    0.00    <D65>   0.02    0.01    0.01    <F11>   1.06    0.41    0.04
<F4>    < A >   0.06    0.04    0.02    <D65>   0.11    0.10    0.08    <F11>   1.64    1.07    0.63
<G4>    < A >   0.05    0.04    0.01    <D65>   0.08    0.06    0.01    <F11>   0.47    1.02    0.17
<H4>    < A >   0.02    0.04    0.02    <D65>   0.01    0.09    0.09    <F11>   1.99    1.35    0.90
<J4>    < A >   0.05    0.01    0.01    <D65>   0.09    0.00    0.05    <F11>   0.71    0.42    0.65

Random uniform sampling (75):
<A1>    < A >   66.57   51.05   12.86   <D65>   88.12   70.21   89.04   <F11>   37.47   2173.53 797.79
<E2>    < A >   8.31    2.14    0.21    <D65>   9.25    5.73    1.72    <F11>   366.73  49.00   7.75
<F4>    < A >   0.44    9.87    0.28    <D65>   5.42    21.32   1.11    <F11>   170.93  359.98  -4.51
<G4>    < A >   36.20   -1.10   -0.33   <D65>   43.52   -0.94   1.10    <F11>   738.09  -1.53   -0.35
<H4>    < A >   58.53   23.27   -2.68   <D65>   43.49   43.48   -0.07   <F11>   1511.99 491.97  -46.10
<J4>    < A >   -3.47   8.82    4.67    <D65>   -6.96   22.39   28.11   <F11>   35.84   214.47  336.46
ABS DIFF:
<A1>    < A >   16.78   13.21   2.32    <D65>   7.33    12.23   8.20    <F11>   1830.33 929.92  93.74
<E2>    < A >   3.68    0.13    0.18    <D65>   3.78    1.31    0.30    <F11>   92.28   17.78   5.58
<F4>    < A >   5.89    1.15    0.46    <D65>   2.66    3.35    1.50    <F11>   52.32   18.70   3.84
<G4>    < A >   1.69    0.28    0.11    <D65>   8.00    0.34    0.01    <F11>   58.09   2.03    3.84
<H4>    < A >   10.66   0.53    0.23    <D65>   30.24   5.47    2.22    <F11>   8.03    320.06  40.90
<J4>    < A >   4.59    0.22    0.76    <D65>   1.43    1.97    4.38    <F11>   5.45    46.31   46.06

Hero wavelength sampling (18):
<A1>    < A >   82.12   38.15   10.17   <D65>   76.86   84.04   85.77   <F11>   2331.29 1041.43 767.03
<E2>    < A >   12.41   1.91    0.07    <D65>   12.88   4.41    2.03    <F11>   278.03  77.85   12.06
<F4>    < A >   6.50    10.95   -0.15   <D65>   2.07    25.39   2.59    <F11>   121.25  357.49  1.89
<G4>    < A >   36.11   -1.33   -0.25   <D65>   35.26   -0.63   1.08    <F11>   749.77  -4.44   1.78
<H4>    < A >   69.10   22.87   -2.92   <D65>   72.54   49.97   -2.32   <F11>   1620.72 928.20  -100.34
<J4>    < A >   1.34    8.34    5.40    <D65>   -5.61   20.63   32.11   <F11>   22.12   207.84  286.19
ABS DIFF:
<A1>    < A >   1.23    0.31    0.37    <D65>   3.93    1.60    4.93    <F11>   463.49  202.18  62.98
<E2>    < A >   0.42    0.10    0.04    <D65>   0.15    0.01    0.01    <F11>   3.58    11.07   1.27
<F4>    < A >   0.17    0.07    0.03    <D65>   0.69    0.72    0.02    <F11>   2.64    21.19   2.56
<G4>    < A >   1.60    0.05    0.03    <D65>   0.26    0.03    0.01    <F11>   69.77   0.88    1.71
<H4>    < A >   0.09    0.13    0.01    <D65>   1.19    1.02    0.03    <F11>   100.70  116.17  13.34
<J4>    < A >   0.22    0.26    0.03    <D65>   0.08    0.21    0.38    <F11>   8.27    52.94   4.21

Equidistant sampling (8):
<A1>    < A >   84.94   38.18   11.25   <D65>   80.75   83.77   83.83   <F11>   1005.85 1423.68 301.34
<E2>    < A >   12.16   2.00    0.06    <D65>   13.16   4.35    2.15    <F11>   130.72  83.63   2.27
<F4>    < A >   6.60    10.96   -0.08   <D65>   2.64    24.86   2.99    <F11>   105.33  398.50  -23.07
<G4>    < A >   33.95   -1.26   -0.21   <D65>   34.40   -0.34   1.14    <F11>   221.78  19.96   2.33
<H4>    < A >   71.05   22.45   -2.81   <D65>   75.65   48.26   -1.81   <F11>   809.39  954.10  -107.72
<J4>    < A >   1.23    8.69    5.83    <D65>   -5.91   20.82   34.21   <F11>   36.36   242.07  164.39
ABS DIFF:
<A1>    < A >   1.59    0.34    0.71    <D65>   0.04    1.33    2.99    <F11>   861.95  180.07  402.71
<E2>    < A >   0.17    0.01    0.03    <D65>   0.13    0.07    0.13    <F11>   143.73  16.85   11.06
<F4>    < A >   0.27    0.06    0.10    <D65>   0.12    0.19    0.38    <F11>   13.28   19.82   22.40
<G4>    < A >   0.56    0.12    0.01    <D65>   1.12    0.26    0.05    <F11>   458.22  23.52   1.16
<H4>    < A >   1.86    0.29    0.10    <D65>   1.92    0.69    0.48    <F11>   710.63  142.07  20.72
<J4>    < A >   0.11    0.09    0.40    <D65>   0.38    0.40    1.72    <F11>   5.97    18.71   126.01

Random uniform sampling (125):
<A1>    < A >   61.85   36.93   9.07    <D65>   111.24  75.17   76.37   <F11>   2002.70 1418.93 553.74
<E2>    < A >   13.22   2.27    0.01    <D65>   13.26   3.90    1.86    <F11>   268.89  79.26   9.28
<F4>    < A >   2.89    10.67   0.10    <D65>   2.71    21.89   2.28    <F11>   13.79   583.95  -23.49
<G4>    < A >   34.95   -1.61   -0.21   <D65>   18.93   0.63    1.50    <F11>   876.88  -13.80  9.07
<H4>    < A >   67.14   22.62   -2.88   <D65>   75.32   55.91   -2.63   <F11>   1239.26 848.32  -83.55
<J4>    < A >   2.05    8.95    4.88    <D65>   -9.24   25.24   39.19   <F11>   -15.86  251.24  297.17
ABS DIFF:
<A1>    < A >   21.50   0.91    1.47    <D65>   30.45   7.27    4.47    <F11>   134.90  175.32  150.31
<E2>    < A >   1.23    0.26    0.02    <D65>   0.23    0.52    0.16    <F11>   5.56    12.48   4.05
<F4>    < A >   3.44    0.35    0.28    <D65>   0.05    2.78    0.33    <F11>   104.82  205.27  22.82
<G4>    < A >   0.44    0.23    0.01    <D65>   16.59   1.23    0.41    <F11>   196.88  10.24   5.58
<H4>    < A >   2.05    0.12    0.03    <D65>   1.59    6.96    0.34    <F11>   280.76  36.29   3.45
<J4>    < A >   0.93    0.35    0.55    <D65>   3.71    4.82    6.70    <F11>   46.25   9.54    6.77

Hero wavelength sampling (31):
<A1>    < A >   83.26   38.02   11.30   <D65>   77.72   83.23   81.43   <F11>   1892.25 1067.50 714.70
<E2>    < A >   12.04   1.99    0.05    <D65>   13.10   4.43    2.03    <F11>   275.51  52.35   15.04
<F4>    < A >   6.56    10.95   -0.16   <D65>   2.74    25.07   2.69    <F11>   114.74  376.30  2.41
<G4>    < A >   35.08   -1.42   -0.22   <D65>   36.84   -0.61   1.12    <F11>   742.27  -6.13   3.08
<H4>    < A >   66.57   23.61   -2.95   <D65>   73.74   48.59   -2.15   <F11>   1606.40 774.62  -81.71
<J4>    < A >   1.49    8.28    5.75    <D65>   -5.22   20.79   34.74   <F11>   43.36   271.87  303.61
ABS DIFF:
<A1>    < A >   0.09    0.18    0.76    <D65>   3.07    0.79    0.59    <F11>   24.45   176.11  10.65
<E2>    < A >   0.05    0.02    0.01    <D65>   0.07    0.01    0.01    <F11>   1.06    14.43   1.71
<F4>    < A >   0.23    0.07    0.02    <D65>   0.02    0.40    0.08    <F11>   3.87    2.38    3.08
<G4>    < A >   0.57    0.04    0.00    <D65>   1.32    0.01    0.03    <F11>   62.27   2.57    0.41
<H4>    < A >   2.62    0.87    0.04    <D65>   0.01    0.36    0.14    <F11>   86.38   37.41   5.29
<J4>    < A >   0.37    0.32    0.32    <D65>   0.31    0.37    2.25    <F11>   12.97   11.09   13.21

Equidistant sampling (25):
<A1>    < A >   83.54   37.98   10.57   <D65>   80.75   82.58   81.54   <F11>   1517.57 1137.64 973.71
<E2>    < A >   11.99   2.03    0.03    <D65>   12.99   4.45    2.05    <F11>   215.96  62.78   22.46
<F4>    < A >   6.40    11.02   -0.17   <D65>   2.84    24.64   2.71    <F11>   102.90  349.83  9.76
<G4>    < A >   34.60   -1.35   -0.22   <D65>   35.58   -0.55   1.09    <F11>   563.99  -5.65   11.03
<H4>    < A >   69.33   22.79   -2.90   <D65>   73.64   49.00   -2.18   <F11>   1204.63 769.71  -71.55
<J4>    < A >   1.16    8.64    5.45    <D65>   -5.45   20.46   32.76   <F11>   37.83   223.55  372.00
ABS DIFF:
<A1>    < A >   0.19    0.14    0.03    <D65>   0.04    0.14    0.70    <F11>   350.23  105.97  269.66
<E2>    < A >   0.00    0.02    0.00    <D65>   0.04    0.03    0.03    <F11>   58.49   4.00    9.13
<F4>    < A >   0.07    0.00    0.01    <D65>   0.08    0.03    0.10    <F11>   15.71   28.85   10.43
<G4>    < A >   0.09    0.03    0.00    <D65>   0.06    0.05    0.00    <F11>   116.01  2.09    7.54
<H4>    < A >   0.14    0.05    0.01    <D65>   0.09    0.05    0.11    <F11>   315.39  42.32   15.45
<J4>    < A >   0.04    0.04    0.02    <D65>   0.08    0.04    0.27    <F11>   7.44    37.23   81.60

Random uniform sampling (200):
<A1>    < A >   83.32   42.87   10.06   <D65>   56.93   87.43   94.60   <F11>   1155.01 913.83  772.70
<E2>    < A >   10.78   2.53    0.10    <D65>   11.55   5.18    2.14    <F11>   280.05  71.49   26.75
<F4>    < A >   7.41    10.75   -0.07   <D65>   5.84    20.65   2.16    <F11>   38.26   505.66  -11.61
<G4>    < A >   43.79   -1.98   -0.37   <D65>   32.10   -0.31   1.20    <F11>   1002.79 -13.53  -6.88
<H4>    < A >   45.81   22.95   -2.36   <D65>   49.76   43.93   -0.68   <F11>   2401.79 439.88  -53.97
<J4>    < A >   0.06    9.72    5.30    <D65>   -8.96   23.94   31.22   <F11>   3.79    353.13  290.33
ABS DIFF:
<A1>    < A >   0.03    5.03    0.48    <D65>   23.86   4.99    13.76   <F11>   712.79  329.78  68.65
<E2>    < A >   1.21    0.52    0.07    <D65>   1.48    0.76    0.12    <F11>   5.60    4.71    13.42
<F4>    < A >   1.08    0.27    0.11    <D65>   3.08    4.02    0.45    <F11>   80.35   126.98  10.94
<G4>    < A >   9.28    0.60    0.15    <D65>   3.42    0.29    0.11    <F11>   322.79  9.97    10.37
<H4>    < A >   23.38   0.21    0.55    <D65>   23.97   5.02    1.61    <F11>   881.77  372.15  33.03
<J4>    < A >   1.06    1.12    0.13    <D65>   3.43    3.52    1.27    <F11>   26.60   92.35   0.07

Hero wavelength sampling (50):
<A1>    < A >   81.23   38.54   10.77   <D65>   80.34   82.71   82.10   <F11>   1983.68 1204.97 765.35
<E2>    < A >   12.24   1.99    0.03    <D65>   13.44   4.36    2.15    <F11>   228.38  60.48   12.49
<F4>    < A >   6.41    11.16   -0.18   <D65>   2.91    24.95   2.72    <F11>   107.60  442.80  -7.81
<G4>    < A >   34.12   -1.30   -0.22   <D65>   34.79   -0.51   1.05    <F11>   841.53  -8.16   3.59
<H4>    < A >   68.20   23.00   -2.90   <D65>   71.98   50.01   -2.27   <F11>   1478.07 911.21  -97.57
<J4>    < A >   1.15    8.65    5.50    <D65>   -5.23   20.30   33.04   <F11>   48.43   239.86  299.54
ABS DIFF:
<A1>    < A >   2.12    0.70    0.23    <D65>   0.45    0.27    1.26    <F11>   115.88  38.64   61.30
<E2>    < A >   0.25    0.02    0.00    <D65>   0.41    0.06    0.13    <F11>   46.07   6.30    0.84
<F4>    < A >   0.08    0.14    0.00    <D65>   0.15    0.28    0.11    <F11>   11.01   64.12   7.14
<G4>    < A >   0.39    0.08    0.00    <D65>   0.73    0.09    0.04    <F11>   161.53  4.60    0.10
<H4>    < A >   0.99    0.26    0.01    <D65>   1.75    1.06    0.02    <F11>   41.95   99.18   10.57
<J4>    < A >   0.03    0.05    0.07    <D65>   0.30    0.12    0.55    <F11>   18.04   20.92   9.14

Equidistant sampling (45):
<A1>    < A >   92.19   42.25   11.72   <D65>   89.51   91.87   89.86   <F11>   2093.44 1310.76 822.78
<E2>    < A >   13.23   2.26    0.04    <D65>   14.42   4.94    2.26    <F11>   306.09  70.62   16.23
<F4>    < A >   7.07    12.24   -0.18   <D65>   3.15    27.37   2.99    <F11>   136.77  399.33  3.87
<G4>    < A >   37.95   -1.43   -0.25   <D65>   39.30   -0.57   1.20    <F11>   764.61  -4.53   4.38
<H4>    < A >   76.51   25.36   -3.22   <D65>   81.72   54.45   -2.45   <F11>   1700.74 855.30  -89.36
<J4>    < A >   1.27    9.60    6.04    <D65>   -6.09   22.75   36.13   <F11>   37.47   276.21  336.25
ABS DIFF:
<A1>    < A >   8.84    4.41    1.18    <D65>   8.72    9.43    9.02    <F11>   225.64  67.15   118.73
<E2>    < A >   1.24    0.25    0.00    <D65>   1.39    0.52    0.24    <F11>   31.64   3.84    2.90
<F4>    < A >   0.74    1.22    0.00    <D65>   0.39    2.70    0.38    <F11>   18.16   20.65   4.54
<G4>    < A >   3.44    0.05    0.03    <D65>   3.78    0.03    0.11    <F11>   84.61   0.97    0.89
<H4>    < A >   7.32    2.62    0.31    <D65>   7.99    5.50    0.16    <F11>   180.72  43.27   2.36
<J4>    < A >   0.15    1.00    0.61    <D65>   0.56    2.33    3.64    <F11>   7.08    15.43   45.85
```

# Polarization
```
./polarization
Light: vec4(100.000000, 0.000000, 0.000000, 0.000000)
id      n1      k1      n2      k2      delta   rho     phi     filter
1       1.330   0.000   1.500   0.000   53.000  0.000   56.000  ---
2       1.330   0.000   1.500   0.000   53.000  0.000   56.000  0.000
3       1.330   0.000   1.500   0.000   53.000  0.000   56.000  90.000
4       0.662   0.000   0.662   0.000   48.000  0.000   54.600  0.000
5       0.662   0.000   0.662   0.000   48.000  0.000   54.600  90.000
6       0.662   0.000   0.662   0.000   48.000  0.000   54.600  45.000
7       1.120   2.160   0.608   2.120   48.000  34.000  20.000  ---
8       1.120   2.160   0.608   2.120   48.000  34.000  20.000  0.000
9       1.120   2.160   0.608   2.120   48.000  34.000  20.000  90.000

Test runs:
id      s0      s1      s2      s3
1       0.560   0.560   0.000   0.000
2       0.560   0.560   0.000   0.000
3       0.000   0.000   -0.000  -0.000
4       50.000  50.000  0.000   0.000
5       50.000  -50.000 -0.000  0.000
6       50.000  -0.000  0.409   -49.998
7       33.996  9.016   -0.759  -0.508
8       19.124  10.987  -13.008 -8.708
9       14.871  -1.971  12.249  8.200
```
